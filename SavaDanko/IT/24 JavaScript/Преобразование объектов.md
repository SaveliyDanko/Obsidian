#### Преобразование объектов в примитивы
JavaScript автоматически преобразует объекты в примитивы в различных контекстах, таких как математические операции или конкатенация строк. Преобразование объекта в примитивное значение осуществляется с помощью встроенного механизма, известного как "преобразование объекта к примитиву".

#### Преобразование объектов: понятие и процессы
Когда JavaScript сталкивается с необходимостью преобразовать объект в примитив, он вызывает специальные методы объекта, которые должны возвращать примитивное значение.

Для преобразования объекта в примитив есть три типа преобразований:
1. "string" — для преобразования объекта в строку.
2. "number" — для преобразования объекта в число.
3. "default" — преобразование, которое используется в редких случаях, таких как использование объекта в неочевидных контекстах.

#### Преобразование: символьный метод `Symbol.toPrimitive`
Для настройки поведения объекта при преобразовании его в примитив, можно использовать метод с ключом `Symbol.toPrimitive`. Он задаётся как метод объекта и используется, когда требуется преобразование в примитив:
```js
let user = {
    name: "John",
    age: 30,

    [Symbol.toPrimitive](hint) {
        console.log(`hint: ${hint}`);
        return hint == "string" ? `{name: "${this.name}"}` : this.age;
    }
};

console.log(+user); // hint: number -> 30
console.log(`${user}`); // hint: string -> {name: "John"}
console.log(user + 500); // hint: default -> 530
```
Метод принимает один аргумент `hint`, который указывает, к какому типу требуется преобразование: `"string"`, `"number"` или `"default"`. В зависимости от этого значения, объект должен возвращать соответствующее примитивное значение.

#### Методы `toString` и `valueOf`
Если у объекта нет метода `Symbol.toPrimitive`, JavaScript попытается вызвать методы `toString` и `valueOf`. В зависимости от типа преобразования, выбирается метод:
1. Для преобразования к типу "string" вызывается метод `toString()`. Если он не существует, используется `valueOf()`.
2. Для преобразования к типу "number" или "default" вызывается метод `valueOf()`. Если он не существует, используется `toString()`.

Пример с реализацией `toString()` и `valueOf()`:
```js
let user = {
    name: "John",
    age: 30,
    toString() {
        return `{name: "${this.name}"}`;
    },
    valueOf() {
        return this.age;
    }
};

console.log(user); // {name: "John"}
console.log(+user); // 30
console.log(user + 100); // 130
```

#### Порядок вызова методов
JavaScript пытается преобразовать объект следующим образом:
1. Сначала вызывается метод `Symbol.toPrimitive` (если он определён).
2. Если метод отсутствует, для преобразования к `"string"` вызывается `toString()`, в противном случае вызывается `valueOf()`.
3. Если ни `toString()`, ни `valueOf()` не возвращают примитивное значение, возникает ошибка.

#### Примеры преобразований
- Преобразование в строку:
    ```js
    let obj = {name: "John"};
    console.log(String(obj)); // [object Object]
    ```
    Для преобразования объекта в строку используется `toString()`, который, если не переопределён, возвращает `[object Object]`.

- Преобразование в число:
    ```js
    let obj = {
        valueOf() {
            return 123;
        }
    };
    console.log(+obj); // 123
    console.log(obj + 50); // 173
    ```

#### Типы преобразований и их "подсказки" (hints)
- "string": происходит, когда объект используется в контексте, где требуется строка, например, при выводе с помощью `alert()` или при конкатенации строк.
- "number": происходит, когда объект используется в математических операциях.
- "default": это преобразование используется, когда нет явной необходимости в строке или числе, например, при сравнении с помощью `==`.

Пример:
```js
let obj = {
    toString() {
        return "2";
    },
    valueOf() {
        return 1;
    }
};

console.log(obj + ""); // "2" (используется toString для конкатенации)
console.log(+obj); // 1 (используется valueOf для численного преобразования)
```
