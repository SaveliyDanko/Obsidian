В архитектуре x86_64 (и других архитектурах) регистры делятся на две основные категории: **Caller-Saved Registers** и **Callee-Saved Registers**. Эти категории определяют, кто отвечает за сохранение и восстановление значений регистров при вызове функций.

### ==Caller-Saved Registers==
**Caller-Saved Registers** (также известные как **Volatile Registers**) — это регистры, которые вызывающая функция (caller) должна сохранить, если она хочет сохранить их значения после вызова другой функции. При вызове функции, эти регистры могут быть изменены (т.е. потеряны) вызываемой функцией (callee).
- **Примеры в x86_64**: `rax`, `rcx`, `rdx`, `rsi`, `rdi`, `r8`-`r15`.
- **Роль**: Если вызывающая функция хочет сохранить значения этих регистров между вызовами функций, она должна самостоятельно сохранить их перед вызовом функции и восстановить после вызова.

### ==Callee-Saved Registers==
**Callee-Saved Registers** (также известные как **Non-Volatile Registers**) — это регистры, которые вызываемая функция (callee) должна сохранить и восстановить, если она изменяет их. Если вызываемая функция изменяет значения этих регистров, она должна гарантировать, что они будут восстановлены до завершения функции.
- **Примеры в x86_64**: `rbx`, `rsp`, `rbp`, `r12`-`r15`.
- **Роль**: Эти регистры сохраняются в стеке или в другом месте при входе в функцию и восстанавливаются перед выходом из функции, чтобы сохранить состояние вызывающего кода.

### ==Примеры==
**Caller-Saved Register Example**:
```asm
; Example caller function
caller_function:
    ; Save rax and rsi before calling callee_function
    push rax
    push rsi

    ; Call the callee function
    call callee_function

    ; Restore rax and rsi after calling callee_function
    pop rsi
    pop rax

    ; Continue with the rest of caller_function
    ret
```

**Callee-Saved Register Example**:
```asm
; Example callee function
callee_function:
    push rbx       ; Save rbx (callee-saved register)
    push rbp       ; Save rbp (callee-saved register)

    ; Function body

    pop rbp        ; Restore rbp
    pop rbx        ; Restore rbx
    ret
```

### ==Почему это важно?==
1. **Соблюдение соглашений о вызовах**: Соглашения о вызовах (calling conventions) определяют, как функции должны работать с регистрами, что обеспечивает совместимость между различными модулями и компиляторами.

2. **Эффективность и производительность**: Caller-saved регистры могут использоваться для передачи значений между функциями без дополнительных затрат на сохранение и восстановление, что делает функции более эффективными.

3. **Безопасность и правильность**: Использование callee-saved регистров гарантирует, что вызывающая функция может полагаться на сохранение состояния этих регистров между вызовами функций, что важно для корректной работы многократных вызовов и рекурсии.

### ==Резюме==
- **Caller-Saved Registers**: Вызывающая функция должна сохранить и восстановить значения.
- **Callee-Saved Registers**: Вызываемая функция должна сохранить и восстановить значения.
Эти соглашения помогают организовать эффективное использование регистров и обеспечить корректную работу программы, особенно в сложных системах с многократными вызовами функций и различными уровнями абстракции.

