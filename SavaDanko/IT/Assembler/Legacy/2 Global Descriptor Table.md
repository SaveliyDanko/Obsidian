**Глобальная дескрипторная таблица** (Global Descriptor Table, GDT) — это одна из ключевых структур управления памятью в архитектуре процессоров x86. Она используется в защищённом режиме для определения сегментов памяти, к которым могут обращаться программы. GDT содержит информацию, называемую дескрипторами, которая описывает различные сегменты памяти, такие как сегменты кода, данных или стека. Эти дескрипторы указывают базовый адрес сегмента, его длину и права доступа.

### ==Основные функции GDT:==
1. **Определение сегментов памяти:**
   - GDT описывает память в виде сегментов. Каждый сегмент имеет базовый адрес и размер, которые указаны в дескрипторе.
   - Это позволяет операционной системе и приложениям обращаться к сегментам с разными уровнями доступа, изолировать области памяти и защитить данные.
   
2. **Разграничение привилегий доступа:**
   - В дескрипторах GDT указываются права доступа к сегментам, такие как чтение, запись и выполнение.
   - Это важно для разграничения прав доступа между операционной системой и пользовательскими приложениями. Например, код операционной системы может быть доступен только в кольце 0 (Ring 0), а пользовательские приложения — в кольце 3 (Ring 3).
   
3. **Поддержка защиты памяти:**
   - GDT также помогает в реализации механизма защиты памяти. Если программа пытается обратиться к сегменту с нарушением прав доступа (например, попытка записи в сегмент кода), процессор сгенерирует исключение, что предотвращает неправильную работу программы или системы.

### ==Структура GDT:==
Каждая запись в GDT называется **дескриптором сегмента**, и она содержит следующие поля:
1. **Базовый адрес (Base):**
   - Это начальный адрес сегмента в памяти, откуда начинается сегмент. Адрес задаётся 32-битным значением (в 32-битных системах) или 64-битным (в 64-битных системах).

2. **Размер сегмента (Limit):**
   - Размер сегмента указывает, сколько байт содержит сегмент. Процессор использует это значение для того, чтобы ограничить доступ к сегменту и предотвратить обращения за его пределы.

3. **Тип сегмента и права доступа (Access Byte):**
   - Этот байт определяет тип сегмента (код или данные) и его права доступа (например, разрешена ли запись, можно ли выполнить код). Также он определяет привилегии доступа (например, доступен ли сегмент в кольце 0 или кольце 3).

4. **Флаги (Flags):**
   - Содержат дополнительные параметры сегмента, такие как режим адресации (16-битный или 32-битный) и гранулярность (управляет тем, интерпретируется ли поле размера как байты или страницы).

### ==Пример дескриптора сегмента:==
Дескриптор сегмента в GDT обычно выглядит следующим образом:
- **Base (31:24)** | **G** | **D** | **L** | **AVL** | **Limit (19:16)** | **Access Byte** | **Base (23:16)** | **Base (15:0)** | **Limit (15:0)**
  
- **Base** — базовый адрес сегмента.
- **G** (гранулярность) — указывает, является ли сегмент в байтах или страницах (страница = 4096 байт).
- **D** — размер операндов: 16 или 32 бита.
- **L** — 64-битный сегмент кода.
- **Limit** — размер сегмента.
- **Access Byte** — байт доступа, который определяет права доступа и тип сегмента.

### ==Пример:==
- Если дескриптор описывает сегмент кода для операционной системы, он может быть настроен как:
  - **Тип:** сегмент кода.
  - **Права:** только выполнение (нельзя писать или читать).
  - **Привилегия:** кольцо 0 (для ядра операционной системы).
  
- Для сегмента данных пользовательской программы:
  - **Тип:** сегмент данных.
  - **Права:** чтение и запись.
  - **Привилегия:** кольцо 3 (для приложений).

### ==Настройка GDT:==
GDT управляется через специальные регистры процессора. **GDTR** — это регистр, который указывает на адрес GDT в памяти и содержит её размер. Чтобы задать или изменить GDT, операционная система должна загрузить новый адрес в GDTR с помощью специальной команды `lgdt` (load GDT).

Когда процессор обращается к памяти через селектор сегмента (например, в регистрах `cs`, `ds`, `ss`), он использует GDT для получения информации о сегменте (его базового адреса, размера и прав доступа).

### ==Работа GDT в защищённом режиме:==
В **реальном режиме** процессора сегментация минимальна, и используется фиксированная таблица сегментов, которая не изменяется. Но в **защищённом режиме** GDT используется для полной настройки сегментации, управления памятью и защиты системы. При переходе в защищённый режим операционная система создаёт свою таблицу GDT, которая включает сегменты кода и данных для ядра системы и для пользовательских программ.

### ==Виртуализация и сегментация в x86-64:==
В **64-битных** системах x86-64 сегментация упрощена. Хотя GDT всё ещё существует, большинство сегментов имеют фиксированный базовый адрес, равный нулю, а механизм управления памятью осуществляется преимущественно через **страничную адресацию** (paging). Однако, кольца защиты и разделение уровней привилегий всё ещё поддерживаются.
